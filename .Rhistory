Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
demos<-zelig(demos ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lmdi +
l2fp +
lfp.d +
Lliberaltrade:lfp.d +
Lliberaltrade:l2fp,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(demos)
summary(demos)
strikes<-zelig(strikes ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
spline1 +
spline2 +
spline3 +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lstrikes +
ltv +
lradio +
lnewspaper +
lfp,
model="negbin",
robust=TRUE,
data=df,
cite=FALSE
)
summary(strikes)
strikes<-zelig(strikes ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
spline1 +
spline2 +
spline3 +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lstrikes +
ltv +
lradio +
lnewspaper +
lfp,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(strikes)
strikes<-zelig(strikes ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lstrikes +
ltv +
lradio +
lnewspaper +
lfp,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(strikes)
fp<-zelig(lfp ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
spline1 +
spline2 +
spline3 +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lmdi,
model="logit",
robust=TRUE,
data=df,
cite=FALSE
)
summary(fp)
brazil<-subset(df, Country=="Brazil", select=c("Country", "onset", "Year", "fp", "mdi", "Lopenc", "Ldemo"))
brazil[,5:7]<-as.data.frame(sapply(brazil[,5:7], rescale))
ggplot(brazil, aes(x=Year)) +
geom_line(aes(y=fp), colour="blue") +
geom_line(aes(y=onset), colour="red", alpha=.5) +
geom_line(aes(y=mdi), colour="green") +
geom_line(aes(y=Lopenc), colour="purple")
View(df)
ggplot(df, aes(x=factor(fp), y=log(Lopenc))) +
geom_boxplot()
molten<-subset(df, select=c("scode", "year", "tvscap", "radioscap",
"newspaperscap", "mdi", "mdi.d", "radio.d", "newspaper.d",
"tv.d", "assassins", "demos", "revs", "riots","purges",
"govtcrises", "strikes", "guerrillas", "conflict",
"lriots", "lstrikes", "ldemos", "lmdi", "ltv", "lnewspaper",
"lradio", "lguerrillas", "lrevs", "fp"))
molten<-subset(df, select=c("scode", "year", "mdi", "demos", "strikes", "riots")
)
require(reshape2)
require(reshape2)
?melt
molten<-melt(molten, id.vars=c("scode", "year"))
molten<-melt(molten, id.vars=c("scode", "year"))
ggplot(molten, aes(x=year, y=value)) +
geom_line() +
facet_wrap(.~scode)
ggplot(molten, aes(x=year, y=value)) +
geom_line() +
facet_wrap(~scode)
molten<-melt(molten, id.vars=c("scode", "year"), na.rm=TRUE)
molten<-subset(df, select=c("scode", "year", "mdi", "demos", "strikes", "riots"))
#
#                             "tvscap", "radioscap",
#                       "newspaperscap", "mdi", "mdi.d", "radio.d", "newspaper.d",
#                       "tv.d", "assassins", "demos", "revs", "riots","purges",
#                       "govtcrises", "strikes", "guerrillas", "conflict",
#                       "lriots", "lstrikes", "ldemos", "lmdi", "ltv", "lnewspaper",
#                       "lradio", "lguerrillas", "lrevs", "fp"))
molten<-melt(molten, id.vars=c("scode", "year"), na.rm=TRUE)
ggplot(molten, aes(x=year, y=value)) +
geom_line() +
facet_wrap(~scode)
View(df)
isq.riots<-zelig(riots ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
isq.riots<-zelig(riots ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
lmdi +
Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
isq.riots<-zelig(riots ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
lmdi +
Lopenc*lmdi +
Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
isq.riots<-zelig(riots ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
lmdi +
Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
isq.riots<-zelig(riots ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
lmdi +
lfp +
Lliberaltrade +
Lprotecttrade,
model="negbinom",
robust=TRUE,
data=df,
cite=FALSE
)
summary(isq.riots)
guerrillas<-zelig(guerrillas ~
Ldemo +
Ldemo2 +
Llrgdpch +
lpop +
growth1 +
Lpriecwdum +
nowaryrs +
Lopenc +
Lliberaltrade +
Lprotecttrade +
lmdi +
l2fp +
Lliberaltrade:l2fp,
model="negbinom",
data=df,
cite=FALSE
)
summary(guerrillas)
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.nonlin)
summary(rep.model.lin.log)
summary(rep.model.nonlin)
rep.model.nonlin
rep.model.lin.log
anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
names(rep.model.lin.log)
rep.model.lin.log$deviance
rep.model.nonlin$deviance
rep.model.tv.nonlin <- gam(onset ~ s(ltv) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
rep.model.tv.nonlin <- gam(onset ~ s(l.tv) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ltv",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ltv", "lradio", "lnews",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.nonlin)
anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
rep.model.tv.nonlin <- gam(onset ~ s(l.tv) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
rep.model.tv.nonlin <- gam(onset ~ s(ltv) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.tv.nonlin)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
rep.model.tv.nonlin <- gam(onset ~ s(log(ltv+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.tv.nonlin)
rep.model.tv.nonlin <- gam(onset ~ s(log(ltv+1)) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.tv.nonlin)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
?line
?abline
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0)
?abline
abline(a=0,b=0, col = "lightgray", lty = 3)
summary(rep.model.tv.nonlin)
abline(a=0,b=0, col = "lightgray", lty = 3)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "lightgray", lty = 2)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "lightgray", lty = 4)
abline(a=0,b=0, col = "darkblue", lty = 4)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkblue", lty = 4)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 4)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 5)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 6)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 7)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 8)
plot(rep.model.tv.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 9)
rep.model.tv.nonlin <- gam(onset ~ s(log(lradios+1)) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.tv.nonlin)
rep.model.radio.nonlin <- gam(onset ~ s(log(lradios+1)) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.radio.nonlin)
rep.model.radio.nonlin <- gam(onset ~ s(log(lradio+1)) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.radio.nonlin)
plot(rep.model.radio.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
abline(a=0,b=0, col = "darkred", lty = 9)
rep.model.news.nonlin <- gam(onset ~ s(log(lnews+1)) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.news.nonlin)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "darkred", lty = 9)
rep.model.news.nonlin <- gam(onset ~ s(lnews) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.news.nonlin)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "darkred", lty = 9)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
rep.model.disag.nonlin <- gam(onset ~ s(log(lnews+1)) + s(log(lradio+1)) + s(log(ltv+1)) + lgdpl +
larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.disag.nonlin)
plot(rep.model.disag.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
rep.model.news.nonlin <- gam(onset ~ s(log(lnews+1)) + ltv + lradio + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.news.nonlin)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
rep.model.news.nonlin <- gam(onset ~ s(log(lnews+1)) + log(ltv+1) + log(lradio+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.news.nonlin)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
rep.model.radio.nonlin <- gam(onset ~ s(log(lradio+1)) + log(ltv+1) + log(lnews+1) +  lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.radio.nonlin)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "darkred", lty = 9)
abline(a=0,b=0, col = "darkred", lty = 1)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "lightred", lty = 1)
abline(a=0,b=0, col = "red", lty = 1)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "red", lty = 9)
rep.model.tv.nonlin <- gam(onset ~ s(log(ltv+1)) + log(lnews+1) + log(lradio+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.tv.nonlin)
plot(rep.model.tv.nonlin, main="Effect of TV Density on Civil War Across Levels of TV Density")
abline(a=0,b=0, col = "red", lty = 9)
?par
par(mfrow=c(1,2))
plot(rep.model.tv.nonlin, main="Effect of TV Density on Civil War Across Levels of TV Density")
abline(a=0,b=0, col = "red", lty = 9)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "red", lty = 9)
par(mfrow=c(1,2,3))
par(mfrow=c(1,2,3))
par(mfrow=c(1,3))
plot(rep.model.tv.nonlin, main="Effect of TV Density on Civil War Across Levels of TV Density")
abline(a=0,b=0, col = "red", lty = 9)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "red", lty = 9)
plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "darkred", lty = 9)
rep.model.tv.nonlin <- gam(onset ~ s(log(ltv+1)) + log(lnews+1) + log(lradio+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
plot(rep.model.tv.nonlin, main="Effect of TV Density on Civil War Across Levels of TV Density")
abline(a=0,b=0, col = "red", lty = 9)
rep.model.radio.nonlin <- gam(onset ~ s(log(lradio+1)) + log(ltv+1) + log(lnews+1) +  lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.radio.nonlin)
plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
abline(a=0,b=0, col = "red", lty = 9)
