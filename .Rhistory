legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
plot((Data$NDAM), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Normalized Damage", ylab="Residuals", main="Model fit of normalized damage")
text((Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(4e4, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
Data$NDAM.sq=Data$NDAM.sc^2
modJSVH.sq=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc +NDAM.sq), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sq)
Data$NDAM.sqrt.sc=scale(sqrt(Data$NDAM))
Data$NDAM.abs=Data$NDAM.sqrt^2
modJSVH.sqrt=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sqrt.sc+NDAM.abs), data=Data, family=negbin(theta=c(0.2,10)))
# Fit model with sqrt(NDAM) and sqrt(NDAM)^2. The latter is also abs(NDAM.sc)
Data$NDAM.sqrt.sc=scale(sqrt(Data$NDAM))
Data$NDAM.abs=Data$NDAM.sqrt^2
modJSVH.sqrt=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sqrt.sc+NDAM.abs), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sqrt)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH.sqrt)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH.sqrt)), 0.5+max(resid(modJSVH.sqrt))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH.sqrt), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH.sqrt)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
summary(modJSVH.sqrt)
modJSVH.gender=gam(alldeaths~Gender_MF*(Minpressure.2014.sc+NDAM.sc), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
View(Data)
View(Data)
subset(Data, Gender_MF==1)
females<-subset(Data, Gender_MF==1)
males<-subset(Data, Gender_MF==1)
males<-subset(Data, Gender_MF==0)
summary(males$alldeaths)
summary(females$alldeaths)
plot(males$NDAM, males$alldeaths)
plot(females$NDAM, males$alldeaths)
plot(females$NDAM, females$alldeaths)
plot(Data$NDAM, Data$alldeaths)
plot(males$NDAM, males$alldeaths)
plot(females$NDAM, females$alldeaths)
plot(males$NDAM, males$alldeaths)
plot(females$NDAM, females$alldeaths)
plot(males$NDAM, males$alldeaths)
plot(females$NDAM, females$alldeaths)
plot(males$NDAM, males$alldeaths)
plot(females$NDAM, females$alldeaths)
View(Data)
Data$l.deaths<-lag(Data$alldeaths)
View(Data)
Data$alldeaths<-as.ts(Data$alldeaths)
Data$l.deaths<-lag(Data$alldeaths)
View(Data)
Data$l.deaths<-lag(Data$alldeaths, lag=1)
View(Data)
?lag
Data$l.deaths<-lag(Data$alldeaths, k=1)
View(Data)
?as.ts.
?as.ts
View(Data)
Data$Year<-as.ts(Data$Year)
Data$l.deaths<-lag(Data$alldeaths, k=1)
View(Data)
source(~/Dropbox/R code/shift.R)
source("~/Dropbox/R code/shift.R")
Data$l.deaths<-shift(Data$alldeaths)
Data$l.deaths<-shift(Data$alldeaths, -1)
View(Data)
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc) + l.deaths, data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(log(fitted(modJSVH)), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Fitted values", ylab="Residuals", main="Residual plot against log-transformed fitted values")
text(log(fitted(modJSVH)[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.7,-0.7))
legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
View(Data)
Data<-Data[complete.cases(Data)]
Data<-Data[complete.cases(Data),]
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(log(fitted(modJSVH)), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Fitted values", ylab="Residuals", main="Residual plot against log-transformed fitted values")
text(log(fitted(modJSVH)[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.7,-0.7))
legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
View(females)
plot(Data$Year, Data$alldeaths, col=Data$ColourMF, type="p", pch=15,
xlab="Year", ylab="Number of Deaths", main="Deaths due to hurricanes in the US")
text(Data$Year[BigH], Data$alldeaths[BigH], Data$Name[BigH], adj=c(0.8,1.5))
legend(2000, 250, c("Male", "Female"), fill=c("blue", "pink"))
library(gdata)
library(mgcv)
source("~/Dropbox/R code/shift.R")
# Read in the data
Data=read.xls("http://www.pnas.org/content/suppl/2014/05/30/1402786111.DCSupplemental/pnas.1402786111.sd01.xlsx", nrows=92, as.is=TRUE)
Data$Category=factor(Data$Category)
Data$Gender_MF=factor(Data$Gender_MF)
Data$ColourMF=c("blue", "pink")[as.numeric(Data$Gender_MF)]
BigH=which(Data$alldeaths>100) # Select hurricanes with > 100 deaths
# scale the covariates
Data$Minpressure.2014.sc=scale(Data$Minpressure_Updated.2014)
Data$NDAM.sc=scale(Data$NDAM)
Data$MasFem.sc=scale(Data$MasFem)
Data$l.deaths<-shift(Data$alldeaths, -1)
Data<-Data[complete.cases(Data),]
plot(Data$Year, Data$alldeaths, col=Data$ColourMF, type="p", pch=15,
xlab="Year", ylab="Number of Deaths", main="Deaths due to hurricanes in the US")
text(Data$Year[BigH], Data$alldeaths[BigH], Data$Name[BigH], adj=c(0.8,1.5))
legend(2000, 250, c("Male", "Female"), fill=c("blue", "pink"))
plot(Data$Year, Data$alldeaths, col=Data$ColourMF, type="p", pch=15,
xlab="Year", ylab="Number of Deaths", main="Deaths due to hurricanes in the US")
text(Data$Year[BigH], Data$alldeaths[BigH], Data$Name[BigH], adj=c(0.8,1.5))
legend(2000, 250, c("Male", "Female"), fill=c("blue", "pink"))
plot(Data$Year, Data$alldeaths, col=Data$ColourMF, type="p", pch=15,
xlab="Year", ylab="Number of Deaths", main="Deaths due to hurricanes in the US")
text(Data$Year[BigH], Data$alldeaths[BigH], Data$Name[BigH], adj=c(0.8,1.5))
legend(2000, 250, c("Male", "Female"), fill=c("blue", "pink"))
Data=read.xls("http://www.pnas.org/content/suppl/2014/05/30/1402786111.DCSupplemental/pnas.1402786111.sd01.xlsx", nrows=92, as.is=TRUE)
Data$Category=factor(Data$Category)
Data$Gender_MF=factor(Data$Gender_MF)
Data$ColourMF=c("blue", "pink")[as.numeric(Data$Gender_MF)]
# scale the covariates
Data$Minpressure.2014.sc=scale(Data$Minpressure_Updated.2014)
Data$NDAM.sc=scale(Data$NDAM)
Data$MasFem.sc=scale(Data$MasFem)
Data$l.deaths<-shift(Data$alldeaths, -1)
Data<-Data[complete.cases(Data),]
BigH=which(Data$alldeaths>100) # Select hurricanes with > 100 deaths
plot(Data$Year, Data$alldeaths, col=Data$ColourMF, type="p", pch=15,
xlab="Year", ylab="Number of Deaths", main="Deaths due to hurricanes in the US")
text(Data$Year[BigH], Data$alldeaths[BigH], Data$Name[BigH], adj=c(0.8,1.5))
legend(2000, 250, c("Male", "Female"), fill=c("blue", "pink"))
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc) + l.deaths, data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(log(fitted(modJSVH)), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Fitted values", ylab="Residuals", main="Residual plot against log-transformed fitted values")
text(log(fitted(modJSVH)[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.7,-0.7))
legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
par(mfrow=c(2,1), mar=c(4.1,4.1,3,1))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
plot((Data$NDAM), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Normalized Damage", ylab="Residuals", main="Model fit of normalized damage")
text((Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(4e4, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
Data$NDAM.sq=Data$NDAM.sc^2
modJSVH.sq=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc +NDAM.sq), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sq)
Data$NDAM.sq=Data$NDAM.sc^2
modJSVH.sq=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc +NDAM.sq) + l.deaths, data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sq)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH.sq)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH.sq)), 0.5+max(resid(modJSVH.sq))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH.sq), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH.sq)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
Data$NDAM.sq=Data$NDAM.sc^2
modJSVH.sq=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc +NDAM.sq) + l.deaths, data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sq)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH.sq)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH.sq)), 0.5+max(resid(modJSVH.sq))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH.sq), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH.sq)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
Data$NDAM.sqrt.sc=scale(sqrt(Data$NDAM))
Data$NDAM.abs=Data$NDAM.sqrt^2
modJSVH.sqrt=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sqrt.sc+NDAM.abs), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sqrt)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH.sqrt)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH.sqrt)), 0.5+max(resid(modJSVH.sqrt))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH.sqrt), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH.sqrt)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc) + l.deaths, data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(log(fitted(modJSVH)), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Fitted values", ylab="Residuals", main="Residual plot against log-transformed fitted values")
text(log(fitted(modJSVH)[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.7,-0.7))
legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
plot((Data$NDAM), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Normalized Damage", ylab="Residuals", main="Model fit of normalized damage")
text((Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(4e4, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
modJSVH=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc+l.deaths), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(log(fitted(modJSVH)), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Fitted values", ylab="Residuals", main="Residual plot against log-transformed fitted values")
text(log(fitted(modJSVH)[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.7,-0.7))
legend(1984, 200, c("Male", "Female"), fill=c("blue", "pink"))
plot(Data$Minpressure_Updated.2014, resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Minimum pressure", ylab="Residuals", main="Model fit of minimum pressure")
text(Data$Minpressure_Updated.2014[BigH], resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.2,-0.7))
legend(910, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
plot((Data$NDAM), resid(modJSVH), col=Data$ColourMF, ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))), pch=15,
xlab="Normalized Damage", ylab="Residuals", main="Model fit of normalized damage")
text((Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(4e4, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH)), 0.5+max(resid(modJSVH))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("lightblue", "pink"))
Data$NDAM.sq=Data$NDAM.sc^2
modJSVH.sq=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sc+NDAM.sq+l.deaths), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sq)
par(mfrow=c(1,1), mar=c(4.1,4.1,3,1))
plot(gam(resid(modJSVH.sq)~s(sqrt(Data$NDAM)), data=Data), ylim=c(min(resid(modJSVH.sq)), 0.5+max(resid(modJSVH.sq))),
xlab="Normalized Damage", ylab="Residuals", main="Model fit of (transformed) normalized damage", rug=FALSE, shade=TRUE)
points(sqrt(Data$NDAM), resid(modJSVH.sq), col=Data$ColourMF, pch=15)
text(sqrt(Data$NDAM[BigH]), resid(modJSVH.sq)[BigH], Data$Name[BigH], adj=c(0.8,-0.7))
legend(2e2, 2.8, c("Male", "Female"), fill=c("blue", "pink"))
Data$NDAM.sqrt.sc=scale(sqrt(Data$NDAM))
Data$NDAM.abs=Data$NDAM.sqrt^2
modJSVH.sqrt=gam(alldeaths~MasFem.sc*(Minpressure.2014.sc+NDAM.sqrt.sc+NDAM.abs), data=Data, family=negbin(theta=c(0.2,10)))
summary(modJSVH.sqrt)
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ltv", "lradio", "lnews",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
family=binomial)
# summary(rep.model.nonlin)
anov<-anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
names(anov)<-c("Resid. Df","Resid. Dev", "Df", "Deviance", "P-value")
# plot(rep.model.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
# abline(a=0,b=0, col = "red", lty = 9)
threshold<-mean(warren$mdi[warren$logmdi>=1.99 & warren$logmdi<=2.01], na.rm=TRUE)
numcases<-nrow(subset(warren, mdi<=threshold))
numcases.percent<-round(nrow(subset(warren, mdi<=threshold))/length(warren$mdi)*100)
percentunder4<-round(nrow(subset(warren, mdi<=4))/length(warren$mdi)*100)
percentunder10<-round(nrow(subset(warren, mdi<=10))/length(warren$mdi)*100)
hist(warren$d.mdi)
summary(warren$d.mdi)
summary(subset(warren, mdi<=quantile(warren$mdi, .5, na.rm=TRUE)))
summary(subset(warren, mdi<=quantile(warren$mdi, .5, na.rm=TRUE))$mdi)
hist(subset(warren, mdi<=quantile(warren$mdi, .5, na.rm=TRUE))$mdi)
hist(subset(warren, mdi<=quantile(warren$mdi, .5, na.rm=TRUE))$d.mdi)
summary(subset(warren, mdi<=quantile(warren$mdi, .5, na.rm=TRUE))$d.mdi)
summary(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi)
quantile(warren$mdi, .25, na.rm=TRUE)
min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi)
min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
min(warren$d.mdi, na.rm=TRUE)
max(warren$d.mdi, na.rm=TRUE)
summary(warren$d.mdi)
names(summary(warren$d.mdi))
quantile(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, .25, na.rm=TRUE)
quantile(warren$d.mdi, .25, na.rm=TRUE)
quantile(warren$d.mdi, .75, na.rm=TRUE)
quantile(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, .75, na.rm=TRUE)
quantile(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, .25, na.rm=TRUE)
quantile(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, .75, na.rm=TRUE)
quantile(warren$d.mdi, .25, na.rm=TRUE)
quantile(warren$d.mdi, .75, na.rm=TRUE)
min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
max(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
(min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE))
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ltv", "lradio", "lnews",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
family=binomial)
# summary(rep.model.nonlin)
anov<-anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
names(anov)<-c("Resid. Df","Resid. Dev", "Df", "Deviance", "P-value")
# plot(rep.model.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
# abline(a=0,b=0, col = "red", lty = 9)
threshold<-mean(warren$mdi[warren$logmdi>=1.99 & warren$logmdi<=2.01], na.rm=TRUE)
numcases<-nrow(subset(warren, mdi<=threshold))
numcases.percent<-round(nrow(subset(warren, mdi<=threshold))/length(warren$mdi)*100)
percentunder4<-round(nrow(subset(warren, mdi<=4))/length(warren$mdi)*100)
percentunder10<-round(nrow(subset(warren, mdi<=10))/length(warren$mdi)*100)
mindiff<-min(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
maxdiff<-max(subset(warren, mdi<=quantile(warren$mdi, .25, na.rm=TRUE))$d.mdi, na.rm=TRUE)
rep.model.tv.nonlin <- gam(onset ~ s(log(ltv+1)) + log(lnews+1) + log(lradio+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.tv.nonlin)
# plot(rep.model.tv.nonlin, main="Effect of TV Density on Civil War Across Levels of TV Density")
# abline(a=0,b=0, col = "red", lty = 9)
rep.model.radio.nonlin <- gam(onset ~ s(log(lradio+1)) + log(ltv+1) + log(lnews+1) +  lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.radio.nonlin)
# plot(rep.model.radio.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
# abline(a=0,b=0, col = "red", lty = 9)
rep.model.news.nonlin <- gam(onset ~ s(log(lnews+1)) + log(ltv+1) + log(lradio+1) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
#summary(rep.model.news.nonlin)
# plot(rep.model.news.nonlin, main="Effect of Radio Density on Civil War Across Levels of Radio Density")
# abline(a=0,b=0, col = "darkred", lty = 9)
# Using Zelig
z.nonlin <- zelig(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="logit.gam")
# summary(z.nonlin)
# quantile(warren$mdi, .05, na.rm=TRUE)
# quantile(warren$mdi, .25, na.rm=TRUE)
x.low <- setx(z.nonlin, logmdi= -1.18) # lowest value
x.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .25)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.high)
# summary(s.out)
# plot(s.out)
x.real.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .90, na.rm=TRUE)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.real.high)
# summary(s.out)
# plot(s.out)
rep.model<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="relogit",
robust=TRUE,
cite=F)
rep.belowsixtieth<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=subset(model1vars, mdi<quantile(model1vars$mdi, .60, na.rm=TRUE)),
model="relogit",
robust=TRUE,
cite=F)
# summary(rep.belowsixtieth)
# rep.model.mass<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
#                    deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
#                    spline3,
#                  data=subset(model1vars, mdi>= quantile(model1vars$mdi, .25, na.rm=TRUE)),
#                  model="relogit",
#                  robust=TRUE,
#                  cite=F)
#
# subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
low.model1vars<-subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
(table(warren$onset)[2]/table(warren$onset)[1])*100
(table(low.model1vars$onset)[2]/table(low.model1vars$onset)[1])*100
rep.model2<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=low.model1vars,
model="relogit",
robust=TRUE,
cite=F)
summary(rep.model2)
model2vars<-subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
model2vars<-subset(model2vars, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ld.mdi", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars.unscaled<-model2vars[complete.cases(model2vars),]
model2vars<-model2vars[complete.cases(model2vars),]
detach("package:ZeligGAM", unload=TRUE)
detach("package:Zelig", unload=TRUE)
require(arm)
model2vars[-(1:4)]<-sapply(model2vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
diff.model<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 + spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
disag.model<-zelig(onset ~ ld.news + ld.radio + ld.tv + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
model1vars.unscaled<-model1vars.unscaled[complete.cases(model1vars.unscaled),]
warren.unscaled<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
model="relogit",
robust=TRUE,
cite=F)
mdi.r<-seq(0,300,50) # ~ min to max in sample
x.mdi <- setx(warren.unscaled, mdi= mdi.r)
s.out <- sim(warren.unscaled, x = x.mdi)
pdf(file="figure/mdi_effect.pdf", pointsize=15)
par(xpd=TRUE)
plot(s.out,
main="All Communications Systems",
xlab="Level of Mass Media Density",
ylab="Probability of Civil War Onset",
cex.lab=3,
ci=c(80,95,99.9),
leg=4)
dev.off()
summary(s.out)
s.out
print(s.out)
summary(warren.unscaled$mdi)
summary(model1vars.unscaled$mdi)
sd(model1vars.unscaled$mdi)
sd(model2vars.unscaled$mdi)
summary(model2vars.unscaled$mdi)
x.low<-setx(warren.unscaled, mdi = 0)
quantile(warren.unscaled$mdi, .25, na.rm=TRUE)
quantile(model1vars.unscaled$mdi, .25, na.rm=TRUE)
x.hi<-setx(warren.unscaled, mdi = quantile(model1vars.unscaled$mdi, .25, na.rm=TRUE))
x.low<-setx(warren.unscaled, mdi = 0)
x.hi<-setx(warren.unscaled, mdi = quantile(model1vars.unscaled$mdi, .25, na.rm=TRUE))
s.out <- sim(warren.unscaled, x = x.low, x1 = x.hi)
summary(s.out)
s.out$qi$pd
s.out$qi$pv
s.out$qi$ev
s.out$qi$fd
summary(s.out)
