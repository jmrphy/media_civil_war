xlab="Level of Mass Media Density",
ylab="Probability of Civil War Onset",
cex.lab=3,
ci=c(80,95,99.9),
leg=4)
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.nonlin)
# anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
# plot(rep.model.nonlin, main="title")
# Using Zelig
z.nonlin <- zelig(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="logit.gam")
# summary(z.nonlin)
# quantile(warren$mdi, .05, na.rm=TRUE)
# quantile(warren$mdi, .25, na.rm=TRUE)
x.low <- setx(z.nonlin, logmdi= -1.18) # lowest value
x.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .25)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.high)
# summary(s.out)
# plot(s.out)
x.real.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .90, na.rm=TRUE)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.real.high)
# summary(s.out)
# plot(s.out)
rep.model<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="relogit",
robust=TRUE,
cite=F)
low.model1vars<-subset(warren, mdi<= 10)
(table(warren$onset)[2]/table(warren$onset)[1])*100
(table(low.model1vars$onset)[2]/table(low.model1vars$onset)[1])*100
rep.model2<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=low.model1vars,
model="relogit",
robust=TRUE,
cite=F)
summary(rep.model2)
lowmdi<-subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
model2vars<-subset(lowmdi, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars<-model2vars[complete.cases(model2vars),]
lowmdi<-model2vars
lowmdi<-lowmdi[complete.cases(lowmdi),]
detach("package:ZeligGAM", unload=TRUE)
detach("package:Zelig", unload=TRUE)
require(arm)
model2vars[-(1:4)]<-sapply(model2vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
diff.model<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 + spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
View(model2vars)
model2vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars<-model2vars[complete.cases(model2vars),]
lowmdi<-model2vars
lowmdi<-lowmdi[complete.cases(lowmdi),]
detach("package:ZeligGAM", unload=TRUE)
detach("package:Zelig", unload=TRUE)
require(arm)
model2vars[-(1:4)]<-sapply(model2vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
diff.model<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 + spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
View(model2vars)
model2vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ldmdi", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars<-model2vars[complete.cases(model2vars),]
lowmdi<-model2vars
lowmdi<-lowmdi[complete.cases(lowmdi),]
View(warren)
model2vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ld.mdi", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars<-model2vars[complete.cases(model2vars),]
lowmdi<-model2vars
lowmdi<-lowmdi[complete.cases(lowmdi),]
detach("package:ZeligGAM", unload=TRUE)
detach("package:Zelig", unload=TRUE)
require(arm)
model2vars[-(1:4)]<-sapply(model2vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
diff.model<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 + spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
disag.model<-zelig(onset ~ ld.news + ld.radio + ld.tv + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
model1vars.unscaled<-model1vars.unscaled[complete.cases(model1vars.unscaled),]
warren.unscaled<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
model="relogit",
robust=TRUE,
cite=F)
lowmdi<-model2vars[complete.cases(model2vars),]
diff.unscaled<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=lowmdi,
model="relogit",
robust=TRUE,
cite=F)
require(reshape2)
require(ggplot2)
require(psData)
require(arm)
require(lmtest)
source("~/Dropbox/R Code/shift.R")
################# LOAD/TRANSFORM CLEANED DATA
setwd("~/Dropbox/gh_projects/media_civil_war")
hist_intrastate<-read.csv("data/hist_intrastate.csv")
warren<-read.csv("data/warren.csv")
maddison<-read.csv("data/maddison.csv")
### Aggregate Warren data into yearly means
warren<-subset(warren, select=c("cowcode", "year", "mdi", "tvli", "radioli", "newsli"))
attach(warren)
warren <-aggregate(warren, by=list(year),
FUN=mean, na.rm=TRUE)
detach(warren)
warren$Year<-warren$Group.1
warren$tvlong<-warren$tvli
warren$tvlong[warren$Year<=1944]<-0
### Merge Warren and Intra-state war data
globalmdi<-merge(hist_intrastate, warren, by=c("Year"), all.x=TRUE)
globalmdi.war<-globalmdi[,c("Year", "civil.wars", "onsets", "mdi", "tvli", "radioli", "newsli", "tvlong")]
globalmdi.war$tvlong<-globalmdi.war$tvli
globalmdi.war$tvlong[1:129]<-0
### Load and aggregate cleaned historical GDP data from Maddison
attach(maddison)
maddison <-aggregate(maddison, by=list(id),
FUN=mean, na.rm=TRUE)
detach(maddison)
maddison$Year<-1816:2003
mdi.war.mad<-merge(globalmdi.war, maddison, by=c("Year"))
### Download Polity2
polity <- PolityGet(vars = "polity2")
polity<-subset(polity, year>=1816 & year<=2003)
attach(polity)
polity <-aggregate(polity, by=list(year),
FUN=mean, na.rm=TRUE)
detach(polity)
polity$Year<-polity$year
historical<-merge(mdi.war.mad, polity, by=c("Year"))
historical$d.civil.wars[2:184]<-diff(historical$civil.wars)
historical$d2.civil.wars[3:184]<-diff(historical$civil.wars,2)
historical$d3.civil.wars[4:184]<-diff(historical$civil.wars,3)
historical$d4.civil.wars[5:184]<-diff(historical$civil.wars,4)
historical$ld.civil.wars<-shift(historical$d.civil.wars, -1)
historical$ld2.civil.wars<-shift(historical$d2.civil.wars, -2)
historical$l.civil.wars<-shift(historical$civil.wars, -1)
historical$l2.civil.wars<-shift(historical$civil.wars, -2)
historical$l3.civil.wars<-shift(historical$civil.wars, -3)
historical$d.onsets[2:184]<-diff(historical$onsets)
historical$d2.onsets[3:184]<-diff(historical$onsets,2)
historical$d3.onsets[4:184]<-diff(historical$onsets,3)
historical$d4.onsets[5:184]<-diff(historical$onsets,4)
historical$ld.onsets<-shift(historical$d.onsets, -1)
historical$ld2.onsets<-shift(historical$d2.onsets, -2)
historical$l.onsets<-shift(historical$onsets, -1)
historical$l2.onsets<-shift(historical$onsets, -2)
historical$l3.onsets<-shift(historical$onsets, -3)
historical$d.tvlong[2:184]<-diff(historical$tvlong)
historical$ld.tvlong<-shift(historical$d.tvlong, -1)
historical$l.tvlong<-shift(historical$tvlong, -1)
historical$d.gdppc[2:184]<-diff(historical$gdppc)
historical$l.gdppc<-shift(historical$gdppc, -1)
historical$d.polity2[2:184]<-diff(historical$polity2)
historical$l.polity2<-shift(historical$polity2, -1)
historical$l2.polity2<-shift(historical$polity2, -1)*shift(historical$polity2, -1)
historical$ww2<-ifelse(historical$Year>=1939 & historical$Year>=1944,1,0)
historical$ww1<-ifelse(historical$Year>=1914 & historical$Year>=1918,1,0)
historical$cold<-ifelse(historical$Year>=1947 & historical$Year>=1991,1,0)
longrun<-historical
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(subset(longrun, select=c("Year", "tvlong", "civil.wars", "polity2", "gdppc")), id="Year")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z-scores (standardized values") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars2.unscaled<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2.unscaled<-modelvars2.unscaled[complete.cases(modelvars2.unscaled),]
# require(tseries)
# adf.test(modelvars.unscaled$civil.wars)
# adf.test(modelvars.unscaled$onsets)
# acf(modelvars.unscaled$onsets)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "d.gdppc", "d.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets", "ld.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist1<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 + civil.wars +
l.onsets + d.onsets + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
z.out.hist2<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 + civil.wars +
l.onsets + d.onsets + Year + ww1 + ww2 + cold,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
short<-modelvars2[74:182,] # from 1891
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 + civil.wars +
l.onsets + d.onsets + Year + ww1 + ww2 + cold,
model="negbinom",
robust=TRUE,
data=short,
cite=F)
summary(z.out.hist3)
z.out.hist2.unscaled<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 +
civil.wars + l.onsets + d.onsets + Year + ww1 + ww2 + cold,
model="negbinom",
robust=TRUE,
data=modelvars2.unscaled,
cite=F)
View(historical)
modelvars2.unscaled<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "dgdppc", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2.unscaled<-modelvars2.unscaled[complete.cases(modelvars2.unscaled),]
modelvars2.unscaled<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "d.gdppc", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2.unscaled<-modelvars2.unscaled[complete.cases(modelvars2.unscaled),]
z.out.hist2.unscaled<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 +
civil.wars + l.onsets + d.onsets + Year + ww1 + ww2 + cold,
model="negbinom",
robust=TRUE,
data=modelvars2.unscaled,
cite=F)
modelvars2.unscaled<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "d.polity2", "d.gdppc", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2.unscaled<-modelvars2.unscaled[complete.cases(modelvars2.unscaled),]
z.out.hist2.unscaled<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + d.gdppc + l.polity2 + d.polity2 + l2.polity2 +
civil.wars + l.onsets + d.onsets + Year + ww1 + ww2 + cold,
model="negbinom",
robust=TRUE,
data=modelvars2.unscaled,
cite=F)
diff.unscaled<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=lowmdi,
model="relogit",
robust=TRUE,
cite=F)
lowmdi<-model2vars[complete.cases(model2vars),]
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.nonlin)
# anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
# plot(rep.model.nonlin, main="title")
# Using Zelig
z.nonlin <- zelig(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="logit.gam")
# summary(z.nonlin)
# quantile(warren$mdi, .05, na.rm=TRUE)
# quantile(warren$mdi, .25, na.rm=TRUE)
x.low <- setx(z.nonlin, logmdi= -1.18) # lowest value
x.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .25)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.high)
# summary(s.out)
# plot(s.out)
x.real.high <- setx(z.nonlin, logmdi= quantile(model1vars$logmdi, .90, na.rm=TRUE)) # 25% of cases
s.out <- sim(z.nonlin, x=x.low, x1=x.real.high)
# summary(s.out)
# plot(s.out)
rep.model<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
model="relogit",
robust=TRUE,
cite=F)
# rep.model.mass<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
#                    deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
#                    spline3,
#                  data=subset(model1vars, mdi>= quantile(model1vars$mdi, .25, na.rm=TRUE)),
#                  model="relogit",
#                  robust=TRUE,
#                  cite=F)
#
# subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
low.model1vars<-subset(warren, mdi<= 10)
(table(warren$onset)[2]/table(warren$onset)[1])*100
(table(low.model1vars$onset)[2]/table(low.model1vars$onset)[1])*100
rep.model2<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=low.model1vars,
model="relogit",
robust=TRUE,
cite=F)
summary(rep.model2)
lowmdi<-subset(warren, mdi<= quantile(warren$mdi, .25, na.rm=TRUE))
model2vars<-subset(lowmdi, select=c("country", "year", "onset", "oil2l", "mdi", "lgdpl", "larea",
"lmtn", "lpopl", "deml", "ld.mdi", "ld.tv", "ld.news", "ld.radio",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model2vars<-model2vars[complete.cases(model2vars),]
lowmdi<-model2vars
lowmdi<-lowmdi[complete.cases(lowmdi),]
detach("package:ZeligGAM", unload=TRUE)
detach("package:Zelig", unload=TRUE)
require(arm)
model2vars[-(1:4)]<-sapply(model2vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
diff.model<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 + spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
disag.model<-zelig(onset ~ ld.news + ld.radio + ld.tv + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model2vars,
model="relogit",
robust=TRUE,
cite=F)
model1vars.unscaled<-model1vars.unscaled[complete.cases(model1vars.unscaled),]
warren.unscaled<-zelig(onset ~ mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars.unscaled,
model="relogit",
robust=TRUE,
cite=F)
mdi.r<-seq(0,300,50) # ~ min to max in sample
x.mdi <- setx(warren.unscaled, mdi= mdi.r)
s.out <- sim(warren.unscaled, x = x.mdi)
pdf(file="figure/mdi_effect.pdf", pointsize=15)
par(xpd=TRUE)
plot(s.out,
main="All Communications Systems",
xlab="Level of Mass Media Density",
ylab="Probability of Civil War Onset",
cex.lab=3,
ci=c(80,95,99.9),
leg=4)
dev.off()
diff.unscaled<-zelig(onset ~ ld.mdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=lowmdi,
model="relogit",
robust=TRUE,
cite=F)
ld.mdi.r<-seq(0,3,.5) # ~ min to max in sample
x.ld.mdi <- setx(diff.unscaled, ld.mdi= ld.mdi.r)
s.out.d <- sim(diff.unscaled, x = x.ld.mdi)
pdf(file="figure/d_mdi_effect.pdf", pointsize=15)
par(xpd=TRUE)
plot(s.out.d,
main="Pre- Mass Communications Systems",
xlab="Change in Mass Media Density",
ylab="Probability of Civil War Onset",
cex.lab=3,
ci=c(80,95,99.5),
leg=3)
dev.off()
plot(s.out.d,
main="Pre- Mass Communications Systems",
xlab="Change in Mass Media Density",
ylab="Probability of Civil War Onset",
cex.lab=3,
ci=c(80,95,99.5),
leg=3)
setwd("~/Dropbox/gh_projects/media_civil_war")
require(ggplot2)
require(reshape2)
require(foreign)
require(Zelig)
require(stargazer)
require(arm)
warren<-read.csv("data/warren.csv")
model1vars<-subset(warren, select=c("country", "year", "onset", "oil2l", "mdi", "logmdi", "mdi2", "lgdpl", "larea",
"lmtn", "lpopl", "deml",
"deml2", "ethfracl", "relfracl", "pcyrs", "spline1", "spline2", "spline3"))
model1vars.unscaled<-model1vars
model1vars<-model1vars[complete.cases(model1vars),]
model1vars[-(1:4)]<-sapply(model1vars[-(1:4)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(ZeligGAM)
### Testing non-linearity
# Using MGCV
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.lin.log)
rep.model.nonlin <- gam(onset ~ s(logmdi) + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
# summary(rep.model.nonlin)
# anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
# plot(rep.model.nonlin, main="title")
plot(rep.model.nonlin, main="title")
anova(rep.model.lin.log, rep.model.nonlin, test="Chisq")
plot(rep.model.nonlin, main="Effect of MDI on Civil War at Various Levels of MDI")
plot(rep.model.nonlin, main="Effect of MDI on Civil War Across Levels of MDI")
rep.model.lin.log <- gam(onset ~ logmdi + lgdpl + larea + lmtn + lpopl + oil2l + deml +
deml2 + ethfracl + relfracl + pcyrs + spline1 + spline2 +
spline3,
data=model1vars,
family=binomial)
summary(rep.model.lin.log)
plot(rep.model.lin.log, main="Effect of MDI on Civil War Across Levels of MDI")
length(unique(warren$country))
View(warren)
