View(longrun)
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.hmdi[2:184]<-diff(modelvars$hmdi)
modelvars$l.hmdi[2:184]<-lag(modelvars$hmdi)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-longrun[complete.cases(longrun),]
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.hmdi +
d.hmdi + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-longrun[complete.cases(longrun),]
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-longrun[complete.cases(longrun),]
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
require(reshape2)
require(ggplot2)
require(psData)
################# LOAD/TRANSFORM CLEANED DATA
setwd("~/Dropbox/gh_projects/media_civil_war")
hist_intrastate<-read.csv("data/hist_intrastate.csv")
warren<-read.csv("data/warren.csv")
maddison<-read.csv("data/maddison.csv")
### Aggregate Warren data into yearly means
warren<-subset(warren, select=c("cowcode", "year", "mdi", "tvli", "radioli", "newsli", "tvlong"))
attach(warren)
warren <-aggregate(warren, by=list(year),
FUN=mean, na.rm=TRUE)
detach(warren)
warren$Year<-warren$Group.1
### Merge Warren and Intra-state war data
globalmdi<-merge(hist_intrastate, warren, by=c("Year"), all.x=TRUE)
globalmdi.war<-globalmdi[,c("Year", "civil.wars", "mdi", "tvli", "radioli", "newsli", "tvlong")]
globalmdi.war$tvlong<-globalmdi.war$tvli
globalmdi.war$tvlong[1:129]<-0
### Load and aggregate cleaned historical GDP data from Maddison
attach(maddison)
maddison <-aggregate(maddison, by=list(id),
FUN=mean, na.rm=TRUE)
detach(maddison)
maddison$Year<-1816:2003
mdi.war.mad<-merge(globalmdi.war, maddison, by=c("Year"))
### Download Polity2
polity <- PolityGet(vars = "polity2")
polity<-subset(polity, year>=1816 & year<=2003)
attach(polity)
polity <-aggregate(polity, by=list(year),
FUN=mean, na.rm=TRUE)
detach(polity)
polity$Year<-polity$year
historical<-merge(mdi.war.mad, polity, by=c("Year"))
longrun<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
longrun.unscaled<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(longrun, id="Year")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-longrun[complete.cases(longrun),]
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
View(modelvars)
View(modelvars)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
View(modelvars)
longrun<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
longrun.unscaled<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(longrun, id="Year")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-modelvars[complete.cases(modelvars),]
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
modelvars2<-longrun.unscaled
modelvars2$d.civil.wars[2:184]<-diff(modelvars2$civil.wars)
modelvars2$l.civil.wars[2:184]<-lag(modelvars2$civil.wars)
modelvars2$d.tvlong[2:184]<-diff(modelvars2$tvlong)
modelvars2$l.tvlong[2:184]<-lag(modelvars2$tvlong)
modelvars2$d.gdppc[2:184]<-diff(modelvars2$gdppc)
modelvars2$l.gdppc[2:184]<-lag(modelvars2$gdppc)
modelvars2$d.polity2[2:184]<-diff(modelvars2$polity2)
modelvars2$l.polity2[2:184]<-lag(modelvars2$polity2)
modelvars2$l2.polity2[2:184]<-lag(modelvars2$polity2)*lag(modelvars2$polity2)
modelvars2<-modelvars2[complete.cases(longrun2),]
modelvars2<-modelvars2[complete.cases(modelvars2),]
z.out2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars2)
summary(z.out2)
dtv.r <- seq(min(modelvars2$d.tvlong), max(modelvars2$d.tvlong), .1)
x.dtv<-setx(z.out2, d.tvlong=dtv.r)
s.out<-sim(z.out2, x = x.dtv)
plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
x.lo <- setx(z.out2, d.tvlong=0)
x.hi <- setx(z.out2, d.tvlong=1)
s.out <- sim(z.out2, x = x.lo, x1 = x.hi)
dtv.plot<-plot(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
s.out <- sim(z.out2, x = x.lo, x1 = x.hi)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
summary(modelvars2$d.tvlong)
x.lo <- setx(z.out, d.tvlong=0)
x.hi <- setx(z.out, d.tvlong=1)
s.out <- sim(z.out, x = x.lo, x1 = x.hi)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
plot(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot<-plot(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
names(dtv.plot)
dtv.plot[1]
?plot
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
?plot.ci
dtv.plot<-plot.ci(s.out, var=d.tvlong, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot<-plot.ci(s.out, var="d.tvlong", ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot<-plot.ci(s.out, var="d.tvlong", ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(civil.wars ~ l.gdppc + l.tvlong +
d.tvlong + l.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=modelvars)
summary(z.out)
modelvars$fortyfive<-ifelse(modelvars$Year==1945,1,0)
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
View(modelvars)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-modelvars[complete.cases(modelvars),]
modelvars$fortyfive<-ifelse(modelvars$Year==1945,1,0)
z.out<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + fortyfive + Year,
model="ols",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + fortyfive + Year,
model="ls",
data=modelvars)
summary(z.out)
modelvars$l2.civil.wars[3:184]<-lag(modelvars$civil.wars, lag=2)
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$l2.civil.wars[3:184]<-lag(modelvars$civil.wars, lag=2)
modelvars$l2.tvlong[3:184]<-lag(modelvars$tvlong, lag=2)
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$d2.civil.wars[3:184]<-lag(modelvars$d.civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$l2.civil.wars[3:184]<-lag(modelvars$civil.wars, lag=2)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$d2.tvlong[3:184]<-lag(modelvars$d.tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$l2.tvlong[3:184]<-lag(modelvars$tvlong, lag=2)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$d2.gdppc[3:184]<-lag(modelvars$d.gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$l2.gdppc[3:184]<-lag(modelvars$gdppc, lag=2)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$d2.polity2[3:184]<-lag(modelvars$d.polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[3:184]<-lag(modelvars$polity2, lag=2)
modelvars$l.polity2.2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars$l2.polity2.2[3:184]<-lag(modelvars$polity2, lag=2)*lag(modelvars$polity2, lag=2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(longrun, id="Year")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$d2.civil.wars[3:184]<-lag(modelvars$d.civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$l2.civil.wars[3:184]<-lag(modelvars$civil.wars, lag=2)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$d2.tvlong[3:184]<-lag(modelvars$d.tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$l2.tvlong[3:184]<-lag(modelvars$tvlong, lag=2)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$d2.gdppc[3:184]<-lag(modelvars$d.gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$l2.gdppc[3:184]<-lag(modelvars$gdppc, lag=2)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$d2.polity2[3:184]<-lag(modelvars$d.polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[3:184]<-lag(modelvars$polity2, lag=2)
modelvars$l.polity2.2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars$l2.polity2.2[3:184]<-lag(modelvars$polity2, lag=2)*lag(modelvars$polity2, lag=2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-modelvars[complete.cases(modelvars),]
modelvars$fortyfive<-ifelse(modelvars$Year==1945,1,0)
z.out<-zelig(civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + ld.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2.2 + l.civil.wars + fortyfive + Year,
model="ls",
data=modelvars)
summary(z.out)
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(longrun, id="Year")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars<-subset(historical, select=c("Year", "tvlong", "civil.wars", "gdppc", "polity2"))
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars$d.civil.wars[2:184]<-diff(modelvars$civil.wars)
modelvars$ld.civil.wars[3:184]<-lag(modelvars$d.civil.wars)
modelvars$l.civil.wars[2:184]<-lag(modelvars$civil.wars)
modelvars$l2.civil.wars[3:184]<-lag(modelvars$civil.wars, lag=2)
modelvars$d.tvlong[2:184]<-diff(modelvars$tvlong)
modelvars$ld.tvlong[3:184]<-lag(modelvars$d.tvlong)
modelvars$l.tvlong[2:184]<-lag(modelvars$tvlong)
modelvars$l2.tvlong[3:184]<-lag(modelvars$tvlong, lag=2)
modelvars$d.gdppc[2:184]<-diff(modelvars$gdppc)
modelvars$ld.gdppc[3:184]<-lag(modelvars$d.gdppc)
modelvars$l.gdppc[2:184]<-lag(modelvars$gdppc)
modelvars$l2.gdppc[3:184]<-lag(modelvars$gdppc, lag=2)
modelvars$d.polity2[2:184]<-diff(modelvars$polity2)
modelvars$ld.polity2[3:184]<-lag(modelvars$d.polity2)
modelvars$l.polity2[2:184]<-lag(modelvars$polity2)
modelvars$l2.polity2[3:184]<-lag(modelvars$polity2, lag=2)
modelvars$l.polity2.2[2:184]<-lag(modelvars$polity2)*lag(modelvars$polity2)
modelvars$l2.polity2.2[3:184]<-lag(modelvars$polity2, lag=2)*lag(modelvars$polity2, lag=2)
modelvars[c(2,4:length(names(modelvars)))]<-sapply(modelvars[c(2,4:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-modelvars[complete.cases(modelvars),]
modelvars$fortyfive<-ifelse(modelvars$Year==1945,1,0)
z.out<-zelig(civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + ld.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + ld.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + fortyfive + Year,
model="negbinom",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + ld.civil.wars + fortyfive + Year,
model="ls",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.polity2.2 + l2.civil.wars + fortyfive,
model="ls",
data=modelvars)
summary(z.out)
View(modelvars)
z.out<-zelig(d.civil.wars ~ l2.gdppc + ld.gdppc + l2.tvlong +
ld.tvlong + l2.polity2 +
ld.polity2 + l2.civil.wars + fortyfive,
model="ls",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + ld.gdppc + l.tvlong +
ld.tvlong + l.polity2 +
ld.polity2 + l.civil.wars + fortyfive,
model="ls",
data=modelvars)
summary(z.out)
View(modelvars)
modelvars$fortyfive<-ifelse(modelvars$Year==1944 | modelvars$Year==1945 | modelvars$Year==1946,1,0)
z.out<-zelig(d.civil.wars ~ l.gdppc + ld.gdppc + l.tvlong +
ld.tvlong + l.polity2 +
ld.polity2 + l.civil.wars +,
model="ls",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + ld.gdppc + l.tvlong +
ld.tvlong + l.polity2 +
ld.polity2 + l.civil.wars,
model="ls",
data=modelvars)
summary(z.out)
z.out<-zelig(d.civil.wars ~ l.gdppc + ld.gdppc + l.tvlong +
ld.tvlong + l.polity2 +
ld.polity2 + l.civil.wars + fortyfive,
model="ls",
data=modelvars)
summary(z.out)
