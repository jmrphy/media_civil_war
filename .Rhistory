y = sin(x) + rnorm(1000, sd=0.3)
plot(x,y)
y = sin(2*x) + rnorm(1000, sd=0.3)
plot(x,y)
y = sin(2*x) + rnorm(1000, sd=0.3)
## plot it
y = sin(2*2*x) + rnorm(1000, sd=0.3)
plot(x,y)
?pi
y = sin(-2*2*x) + rnorm(1000, sd=0.3)
plot(x,y)
y = sin(4*4*x) + rnorm(1000, sd=0.3)
plot(x,y)
y = sin(2*2*x) + rnorm(1000, sd=0.3)
plot(x,y)
set.seed(666)
x = seq(0,1,length=1000)
y = sin(2*2*x) + rnorm(1000, sd=0.3)
plot(x,y)
lm1 = lm(y~x)
summary(lm1)
lm10 = lm(y~x
+I(x^2)+I(x^3)+I(x^4)+I(x^5)+I(x^6)+I(x^7)+I(x^8)+I(x^9)+I(x^10))
lm9 = lm(y~x
+I(x^2)+I(x^3)+I(x^4)+I(x^5)+I(x^6)+I(x^7)+I(x^8)+I(x^9))
lm8 = lm(y~x+I(x^2)+I(x^3)+I(x^4)+I(x^5)+I(x^6)+I(x^7)+I(x^8))
lm7 = lm(y~x+I(x^2)+I(x^3)+I(x^4)+I(x^5)+I(x^6)+I(x^7))
lm6 = lm(y~x+I(x^2)+I(x^3)+I(x^4)+I(x^5)+I(x^6))
lm5 = lm(y~x+I(x^2)+I(x^3)+I(x^4)+I(x^5))
lm4 = lm(y~x+I(x^2)+I(x^3)+I(x^4))
lm3= lm(y~x+I(x^2)+I(x^3))
lm2 = lm(y~x+I(x^2))
?I
xplot=seq(0,1,length=200)
lines(xplot,predict(lm3,newdata=data.frame(x=xplot)), col="blue")
lines(xplot,predict(lm2,newdata=data.frame(x=xplot)), col="red")
lines(xplot,predict(lm5,newdata=data.frame(x=xplot)), col="green")
for(degree in 1:10){
fm = lm(y~poly(x,degree))
assign(paste("y",degree,sep="."),fm) # this isn't needed, but
handy
lines(xplot,predict(fm,data.frame(x=xplot)), col=degree)
}
for(degree in 1:10){
fm = lm(y~poly(x,degree))
assign(paste("y",degree,sep="."),fm) # this isn't needed, but handy
lines(xplot,predict(fm,data.frame(x=xplot)), col=degree)
}
lines(xplot,sin(2*pi*xplot),col="gray")
lines(xplot,sin(2*2*xplot),col="gray")
lines(xplot,sin(2*2*xplot),col="gray")
lines(xplot,sin(2*2*xplot),col="gray")
lms = list(lm1,lm2,lm3,lm4,lm5,lm6,lm7,lm8,lm9,lm10)
train = test = rep(0,10) # train = vector(length=10) also works
for(i in 1:10){train[i]=var(lms[i][[1]]$residuals)}
# now compute similarly scaled prediction error for test data
newy = sin(2*2*x)+rnorm(11,sd=.3) # note we used the same x's
for(j in 1:10){test[j] = (1/10)*sum((newy-predict(lms[j]
[[1]],newdata=data.frame(x)))^2)}
for(i in 1:10){train[i]=var(lms[i][[1]]$residuals)}
# now compute similarly scaled prediction error for test data
newy = sin(2*2*x)+rnorm(1000,sd=.3) # note we used the same x's
for(j in 1:10){test[j] = (1/10)*sum((newy-predict(lms[j]
[[1]],newdata=data.frame(x)))^2)}
plot(1:10,train, ylim=c(0,.5))
points(1:10,test,pch="X")cbind(train,test)
points(1:10,test,pch="X")
cbind(train,test)
sin(4*X3)
plot(sin(4*X3))
plot(sin(2*2*X3))
X3 <- sin(2*2*X2) + rnorm(n, 0, sd=1)
plot(X3)
X3 <- rnorm(n, 0, 1)
X1 <- rnorm(n, 0, 1)
X2 <- rnorm(n, 0, 1)
X3 <- rnorm(n, 0, 1)
n <- 1000
n <- 1000
set.seed(101)
sd.value <- 1
X1 <- rnorm(n, 0, 1)
X2 <- rnorm(n, 0, 1)
X3 <- rnorm(n, 0, 1)
Y <- rnorm(n, (0 + 2*X1 + 2*X2 + sin(2*2*X3)), sd.value)
simdata <- data.frame(X1, X2, X3, Y)
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3*X3, data=simdata))
simdata$X3X3<-simdata$X3*simdata$X3
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3*X3, data=simdata))
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3X3, data=simdata))
simdata <- data.frame(X1, X2, X3, Y)
simdata$X3X3<-simdata$X3*simdata$X3
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3X3, data=simdata))
Y <- rnorm(n, (0 + 2*X1 + 2*X2 + 2*X3 + sin(2*2*X3)), sd.value)
simdata <- data.frame(X1, X2, X3, Y)
simdata$X3X3<-simdata$X3*simdata$X3
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3X3, data=simdata))
Y <- rnorm(n, (0 + 2*X1 + 2*X2 + 2*X3 + 2*sin(2*2*X3)), sd.value)
simdata <- data.frame(X1, X2, X3, Y)
simdata$X3X3<-simdata$X3*simdata$X3
summary(lm(Y ~ X1 + X2 + X3 + X3 + X3X3, data=simdata))
require(ggplot2)
require(reshape2)
require(XLConnect)
require(psData)
setwd("~/Dropbox/R Code")
source("shift.R")
setwd("~/Dropbox/Data General/COW Intra-state Wars")
war<-read.csv("Intra-StateWarData_v4.1.csv")
setwd("~/Dropbox/Data General/maddison")
maddison <- readWorksheet(loadWorkbook("mpd_2013-01.xlsx"),sheet=1,startRow=3, header=T)
### Make a full-year dataframe
yearsdf<-as.data.frame(1816:1999)
names(yearsdf)<-"Year"
yearsdf$Year<-as.factor(yearsdf$Year)
### Make a dataframe for # of intrastate war entries each year
startyear.int<-as.data.frame(table(war$StartYear1))
names(startyear.int)<-c("Year", "Entries.int")
class(startyear.int$Year)
### Merge dataframe for total war entries in all years
yearsdf<-merge(yearsdf, startyear.int, by="Year", all.x=TRUE)
yearsdf$Entries.int<-ifelse(is.na(yearsdf$Entries.int), 0, yearsdf$Entries.int)
### Make a dataframe for # of war exits each year
endyear.int<-as.data.frame(table(war$EndYear1))
names(endyear.int)<-c("Year", "Exits.int")
### Merge exits with entries
yearsdf<-merge(yearsdf, endyear.int, by="Year", all.x=TRUE)
yearsdf$Exits.int<-ifelse(is.na(yearsdf$Exits.int), 0, yearsdf$Exits.int)
yearsdf$Exits.int<-as.ts(yearsdf$Exits.int)
yearsdf$Entries.int<-as.ts(yearsdf$Entries.int)
yearsdf$Exits2.int<-shift(yearsdf$Exits.int, -1)
yearsdf$Exits2.int[is.na(yearsdf$Exits2.int)]<-0
yearsdf$civil.wars<-cumsum(yearsdf$Entries.int - yearsdf$Exits2.int)
data<-yearsdf
data<-data[,c(1,5)]
rm(yearsdf)
rm(endyear.int)
rm(startyear.int)
data$Year<-as.numeric(levels(data$Year))
summary(data$Year)
hist<-subset(df, select=c("cowcode", "year", "mdi", "tvli", "radioli", "newsli"))
attach(hist)
hist <-aggregate(hist, by=list(year),
FUN=mean, na.rm=TRUE)
detach(hist)
hist$Year<-as.numeric(levels(hist$Group.1))
historical<-merge(data, hist, by=c("Year"), all.x=TRUE)
historical<-historical[,c(1,2,6:9)]
molten<-melt(historical, id="Year")
global.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
labs(y="Value", title="Mass Media Density and Civil Wars Globally") +
theme_bw()
setwd("~/Dropbox/gh_projects/media_civil_war")
require(foreign)
require(plm)
require(Zelig)
require(ggplot2)
require(reshape2)
# Read in the data from Warren 2014
df<-read.dta("data/Warren_IO_reg_data.dta")
# Make country variable a factor instead of character
df$country<-as.factor(df$country)
# Make new variables panel-style
pdf<-pdata.frame(df, index=c("cowcode", "year"))
pdf$lonset<-lag(pdf$onset)
pdf$lmdi<-lag(pdf$mdi)
pdf$d.mdi<-diff(pdf$mdi, differences=1)
pdf$ld.mdi<-diff(pdf$lmdi, differences=1)
pdf$lnews<-lag(pdf$newsli)
pdf$d.news<-diff(pdf$newsli, differences=1)
pdf$ld.news<-diff(pdf$lnews, differences=1)
pdf$lradio<-lag(pdf$radioli)
pdf$d.radio<-diff(pdf$radioli, differences=1)
pdf$ld.radio<-diff(pdf$lradio, differences=1)
pdf$ltv<-lag(pdf$tvli)
pdf$d.tv<-diff(pdf$tvli, differences=1)
pdf$ld.tv<-diff(pdf$ltv, differences=1)
df<-as.data.frame(pdf)
df<-subset(df, select=(1:length(df)))
hist<-subset(df, select=c("cowcode", "year", "mdi", "tvli", "radioli", "newsli"))
attach(hist)
hist <-aggregate(hist, by=list(year),
FUN=mean, na.rm=TRUE)
detach(hist)
hist$Year<-as.numeric(levels(hist$Group.1))
historical<-merge(data, hist, by=c("Year"), all.x=TRUE)
historical<-historical[,c(1,2,6:9)]
molten<-melt(historical, id="Year")
global.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
labs(y="Value", title="Mass Media Density and Civil Wars Globally") +
theme_bw()
global.plot
historical$tvlong<-historical$tvli
historical$tvlong[1:129]<-0
maddison<-maddison[35:222,]
maddison<-subset(maddison, select=-c(X12.W..Europe, X30.W..Europe., W..Offshoots., X7.E..Europe,
F..Yugoslavia., F..Czecho.slovakia, F..USSR., X8.L..America,
X15.L..America, L..America, X16.E..Asia, X30.E..Asia, X15.W..Asia,
Asia., Total.Africa., Col184, Total.World))
maddison<- reshape(maddison,
varying = c(names(maddison[2:168])),
v.names = "gdppc",
timevar = "Col1",
times = c(names(maddison[2:168])),
direction = "long")
maddison$gdppc[maddison$gdppc==" "]<-NA
maddison$gdppc[maddison$gdppc==""]<-NA
class(maddison$gdppc)
summary(maddison$gdppc)
maddison$gdppc<-gsub(",", "", maddison$gdppc)
maddison$gdppc<-as.numeric(maddison$gdppc)
attach(maddison)
maddison <-aggregate(maddison, by=list(id),
FUN=mean, na.rm=TRUE)
detach(maddison)
maddison$Year<-1816:2003
historical2<-merge(historical, maddison, by=c("Year"))
polity <- PolityGet(vars = "polity2")
polity<-subset(polity, year>=1816 & year<=2003)
attach(polity)
polity <-aggregate(polity, by=list(year),
FUN=mean, na.rm=TRUE)
detach(polity)
polity$Year<-polity$year
historical3<-merge(historical2, polity, by=c("Year"))
longrun<-subset(historical3, select=c("Year", "tvlong", "gdppc", "civil.wars", "polity2"))
longrun.unscaled<-subset(historical3, select=c("Year", "tvlong", "gdppc", "civil.wars", "polity2"))
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[2:length(longrun)]<-sapply(longrun[2:length(longrun)], function(x) rescale(x))
detach("package:arm", unload=TRUE)
require(Zelig)
molten<-melt(longrun, id="Year")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
labs(y="Value", title="Television, Civil War, and Economic Growth in the Long Run") +
theme_bw()
longrun.plot
longrun$d.civil.wars[2:184]<-diff(longrun$civil.wars)
longrun$l.civil.wars[2:184]<-lag(longrun$civil.wars)
longrun$d.tvlong[2:184]<-diff(longrun$tvlong)
longrun$l.tvlong[2:184]<-lag(longrun$tvlong)
longrun$d.gdppc[2:184]<-diff(longrun$gdppc)
longrun$l.gdppc[2:184]<-lag(longrun$gdppc)
longrun$d.polity2[2:184]<-diff(longrun$polity2)
longrun$l.polity2[2:184]<-lag(longrun$polity2)
longrun$l2.polity2[2:184]<-lag(longrun$polity2)*lag(longrun$polity2)
longrun[2:14]<-sapply(longrun[2:14], function(x) x+abs(min(longrun$polity2)))
longrun<-longrun[complete.cases(longrun),]
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
View(longrun)
longrun<-subset(historical3, select=c("Year", "tvlong", "gdppc", "civil.wars", "polity2"))
longrun.unscaled<-subset(historical3, select=c("Year", "tvlong", "gdppc", "civil.wars", "polity2"))
detach("package:Zelig", unload=TRUE)
require(arm)
View(longrun)
View(longrun)
longrun[c(2,3,5)]<-sapply(longrun[c(2,3,5)], function(x) rescale(x))
View(longrun)
longrun<-subset(historical3, select=c("Year", "tvlong", "gdppc", "civil.wars", "polity2"))
longrun[c(2,3,5)]<-sapply(longrun[c(2,3,5)], function(x) rescale(x))
longrun$d.civil.wars[2:184]<-diff(longrun$civil.wars)
longrun$l.civil.wars[2:184]<-lag(longrun$civil.wars)
longrun$d.tvlong[2:184]<-diff(longrun$tvlong)
longrun$l.tvlong[2:184]<-lag(longrun$tvlong)
longrun$d.gdppc[2:184]<-diff(longrun$gdppc)
longrun$l.gdppc[2:184]<-lag(longrun$gdppc)
longrun$d.polity2[2:184]<-diff(longrun$polity2)
longrun$l.polity2[2:184]<-lag(longrun$polity2)
longrun$l2.polity2[2:184]<-lag(longrun$polity2)*lag(longrun$polity2)
View(longrun)
View(longrun)
View(longrun)
longrun[c(2,3,5:14)]<-sapply(longrun[c(2,3,5:14)], function(x) x+abs(min(longrun$polity2)))
View(longrun)
longrun<-longrun[complete.cases(longrun),]
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
View(longrun)
longrun2<-longrun.unscaled
longrun2$d.civil.wars[2:184]<-diff(longrun2$civil.wars)
longrun2$l.civil.wars[2:184]<-lag(longrun2$civil.wars)
longrun2$d.tvlong[2:184]<-diff(longrun2$tvlong)
longrun2$l.tvlong[2:184]<-lag(longrun2$tvlong)
longrun2$d.gdppc[2:184]<-diff(longrun2$gdppc)
longrun2$l.gdppc[2:184]<-lag(longrun2$gdppc)
longrun2$d.polity2[2:184]<-diff(longrun2$polity2)
longrun2$l.polity2[2:184]<-lag(longrun2$polity2)
longrun2$l2.polity2[2:184]<-lag(longrun2$polity2)*lag(longrun2$polity2)
longrun2<-longrun2[complete.cases(longrun2),]
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
require(Zelig)
longrun<-longrun[complete.cases(longrun),]
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
longrun2<-longrun.unscaled
longrun2$d.civil.wars[2:184]<-diff(longrun2$civil.wars)
longrun2$l.civil.wars[2:184]<-lag(longrun2$civil.wars)
longrun2$d.tvlong[2:184]<-diff(longrun2$tvlong)
longrun2$l.tvlong[2:184]<-lag(longrun2$tvlong)
longrun2$d.gdppc[2:184]<-diff(longrun2$gdppc)
longrun2$l.gdppc[2:184]<-lag(longrun2$gdppc)
longrun2$d.polity2[2:184]<-diff(longrun2$polity2)
longrun2$l.polity2[2:184]<-lag(longrun2$polity2)
longrun2$l2.polity2[2:184]<-lag(longrun2$polity2)*lag(longrun2$polity2)
longrun2<-longrun2[complete.cases(longrun2),]
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
longrun<-longrun[complete.cases(longrun),]
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
View(longrun)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
model<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun)
summary(model)
longrun2<-longrun.unscaled
longrun2$d.civil.wars[2:184]<-diff(longrun2$civil.wars)
longrun2$l.civil.wars[2:184]<-lag(longrun2$civil.wars)
longrun2$d.tvlong[2:184]<-diff(longrun2$tvlong)
longrun2$l.tvlong[2:184]<-lag(longrun2$tvlong)
longrun2$d.gdppc[2:184]<-diff(longrun2$gdppc)
longrun2$l.gdppc[2:184]<-lag(longrun2$gdppc)
longrun2$d.polity2[2:184]<-diff(longrun2$polity2)
longrun2$l.polity2[2:184]<-lag(longrun2$polity2)
longrun2$l2.polity2[2:184]<-lag(longrun2$polity2)*lag(longrun2$polity2)
longrun2<-longrun2[complete.cases(longrun2),]
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
x.out <- setx(model2)
s.out <- sim(model2, x = x.out)
summary(longrun2$d.tvlong)
summary(longrun2$tvlong)
dtv.r <- min(longrun2$d.tvlong):max(longrun2$d.tvlong)
x.dtv<-setx(model2, d.tvlong=dtv.r)
s.out<-sim(model2, x = x.dtv)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density (Global Mean)",
ylab="Expected Number of Civil Wars")
dtv.plot
min(longrun2$d.tvlong)
summary(model2)
min(longrun2$d.tvlong)
max(longrun2$d.tvlong)
dtv.r <- seq(min(longrun2$d.tvlong), max(longrun2$d.tvlong), .1)
x.dtv<-setx(model2, d.tvlong=dtv.r)
s.out<-sim(model2, x = x.dtv)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density (Global Mean)",
ylab="Expected Number of Civil Wars")
?plot.ci
x.out <- setx(model2)
s.out <- sim(model2, x = x.out)
dtv.r <- seq(min(longrun2$d.tvlong), max(longrun2$d.tvlong), .1)
x.dtv<-setx(model2, d.tvlong=dtv.r)
dtv.r
s.out<-sim(model2, x = x.dtv)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="pv", leg=3, ylim=0:1,
xlab="Change in Television Density (Global Mean)",
ylab="Expected Number of Civil Wars")
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot
x.lo <- setx(model2, d.tvlong=min(longrun2$d.tvlong))
x.hi <- setx(model2, d.tvlong=mean(longrun2$d.tvlong))
s.out.fdi <- sim(model2, x = x.lo, x1 = x.hi)
mean(s.out.fdi$qi$fd)
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot
?plot.ci
dtv.plot<-plot(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
?plot.ci
detach("package:arm", unload=TRUE)
require(Zelig)
View(longrun)
View(longrun2)
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
x.out <- setx(model2)
s.out <- sim(model2, x = x.out)
dtv.r <- seq(min(longrun2$d.tvlong), max(longrun2$d.tvlong), .1)
x.dtv<-setx(model2, d.tvlong=dtv.r)
s.out<-sim(model2, x = x.dtv)
plot(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
warnings()
dtv.plot<-plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
dtv.plot
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + Year,
model="negbinom",
data=longrun2)
summary(model2)
dtv.r <- seq(min(longrun2$d.tvlong), max(longrun2$d.tvlong), .1)
x.dtv<-setx(model2, d.tvlong=dtv.r)
s.out<-sim(model2, x = x.dtv)
plot.ci(s.out, ci=c(90,95,99), qi="ev", leg=3, ylim=0:1,
xlab="Change in Television Density Global Mean",
ylab="Expected Number of Civil Wars")
model2<-zelig(civil.wars ~ l.gdppc + d.gdppc + l.tvlong +
d.tvlong + l.polity2 +
d.polity2 + l2.polity2 + l.civil.wars + d.civil.wars + Year,
model="negbinom",
data=longrun2)
summary(model2)
