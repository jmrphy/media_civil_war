################# LOAD/TRANSFORM CLEANED DATA
setwd("~/Dropbox/gh_projects/media_civil_war")
hist_intrastate<-read.csv("data/hist_intrastate.csv")
warren<-read.csv("data/warren.csv")
maddison<-read.csv("data/maddison.csv")
### Aggregate Warren data into yearly means
warren<-subset(warren, select=c("cowcode", "year", "mdi", "tvli", "radioli", "newsli"))
attach(warren)
warren <-aggregate(warren, by=list(year),
FUN=mean, na.rm=TRUE)
detach(warren)
warren$Year<-warren$Group.1
warren$tvlong<-warren$tvli
warren$tvlong[warren$Year<=1944]<-0
### Merge Warren and Intra-state war data
globalmdi<-merge(hist_intrastate, warren, by=c("Year"), all.x=TRUE)
globalmdi.war<-globalmdi[,c("Year", "civil.wars", "onsets", "mdi", "tvli", "radioli", "newsli", "tvlong")]
globalmdi.war$tvlong<-globalmdi.war$tvli
globalmdi.war$tvlong[1:129]<-0
### Load and aggregate cleaned historical GDP data from Maddison
attach(maddison)
maddison <-aggregate(maddison, by=list(id),
FUN=mean, na.rm=TRUE)
detach(maddison)
maddison$Year<-1816:2003
mdi.war.mad<-merge(globalmdi.war, maddison, by=c("Year"))
### Download Polity2
polity <- PolityGet(vars = "polity2")
polity<-subset(polity, year>=1816 & year<=2003)
attach(polity)
polity <-aggregate(polity, by=list(year),
FUN=mean, na.rm=TRUE)
detach(polity)
polity$Year<-polity$year
historical<-merge(mdi.war.mad, polity, by=c("Year"))
historical$d.civil.wars[2:184]<-diff(historical$civil.wars)
historical$d2.civil.wars[3:184]<-diff(historical$civil.wars, 2)
historical$ld.civil.wars<-shift(historical$d.civil.wars, -1)
historical$ld2.civil.wars<-shift(historical$d2.civil.wars, -1)
historical$l.civil.wars<-shift(historical$civil.wars, -1)
historical$l2.civil.wars<-shift(historical$civil.wars, -2)
historical$l3.civil.wars<-shift(historical$civil.wars, -3)
historical$d.onsets[2:184]<-diff(historical$onsets)
historical$d2.onsets[3:184]<-diff(historical$onsets, 2)
historical$ld.civil.wars<-shift(historical$d.onsets, -1)
historical$ld2.onsets<-shift(historical$d2.onsets, -1)
historical$l.onsets<-shift(historical$onsets, -1)
historical$l2.onsets<-shift(historical$onsets, -2)
historical$l3.onsets<-shift(historical$onsets, -3)
historical$d.tvlong[2:184]<-diff(historical$tvlong)
historical$ld.tvlong<-shift(historical$d.tvlong, -1)
historical$l.tvlong<-shift(historical$tvlong, -1)
historical$d.gdppc[2:184]<-diff(historical$gdppc)
historical$l.gdppc<-shift(historical$gdppc, -1)
historical$d.polity2[2:184]<-diff(historical$polity2)
historical$l.polity2<-shift(historical$polity2, -1)
historical$l2.polity2<-shift(historical$polity2, -1)*shift(historical$polity2, -1)
historical$ww2<-ifelse(historical$Year>=1939 & historical$Year>=1944,1,0)
historical$ww1<-ifelse(historical$Year>=1914 & historical$Year>=1918,1,0)
historical$cold<-ifelse(historical$Year>=1948 & historical$Year>=1991,1,0)
longrun<-historical
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(historical, id="Year")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars.unscaled<-subset(historical, select=c("Year", "tvlong", "civil.wars", "onsets", "gdppc", "polity2"))
require(tseries)
adf.test(longrun.unscaled$civil.wars)
# modelvars[c(2,5:length(names(modelvars)))]<-sapply(modelvars[c(2,5:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-subset(historical, select=c("Year", "d.civil.wars",  "ww1", "ww2", "cold", "l.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars"))
modelvars[c(1,6:length(names(modelvars)))]<-sapply(modelvars[c(1,6:length(names(modelvars)))], function(x) rescale(x))
modelvars<-modelvars[complete.cases(modelvars),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist1<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist1)
plot(modelvars$Year, z.out.hist1$result$residuals)
plot(modelvars$l.tvlong, z.out.hist1$result$residuals)
plot(modelvars$d2.civil.wars, z.out.hist1$result$residuals)
# plot(z.out$result$fitted.values, z.out$result$residuals, )
# plot(z.out$result$residuals, z.out$result$y)
z.out.hist2<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year +
ww1 + ww2 + cold,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist2)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
adf.test(longrun.unscaled$onsets)
acf(longrun.unscaled$onsets)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars", "l.onsets",
"d2.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2onsets",
"d2.onsets"))
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + l2.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(onsets ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
detach("package:arm", unload=TRUE)
require(Zelig)
View(modelvars2)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
plot(modelvars2$Year, z.out.hist3$result$residuals)
plot(modelvars2$l.tvlong, z.out.hist3$result$residuals)
plot(modelvars2$d2.civil.wars, z.out.hist3$result$residuals)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + ld.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.onsets + d2.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l.onsets + d2.onsets + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
hist(modelvars2$d.onsets)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
plot(modelvars2$Year, z.out.hist3$result$residuals)
plot(modelvars2$l.tvlong, z.out.hist3$result$residuals)
plot(modelvars2$d2.civil.wars, z.out.hist3$result$residuals)
d2.onsets
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l.civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l.civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l.civil.wars + l.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
plot(modelvars2$Year, z.out.hist3$result$residuals)
plot(modelvars2$l.tvlong, z.out.hist3$result$residuals)
plot(modelvars2$d2.civil.wars, z.out.hist3$result$residuals)
hist(modelvars2$d.onsets)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(d.onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d2.onsets + ww1 + ww2 + cold + Year,
model="ls",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + ld.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
source("http://www.utdallas.edu/~pbrandt/code/pests-example.r")
source("http://www.utdallas.edu/~pbrandt/code/pests-example.r")
source("http://www.utdallas.edu/~pbrandt/code/pests.r")
pewmod<-Pewma(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
data=modelvars2)
pewmod<-Pewma(onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.civil.wars + modelvars2$l.onsets + modelvars2$d.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.civil.wars + modelvars2$l.onsets + modelvars2$d.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.civil.wars + modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
View(modelvars2)
modelvars2.1<-sapply(model2vars, function(x) x+1)
modelvars2.1<-sapply(modelvars2, function(x) x+1)
View(modelvars2.1)
modelvars2.1<-sapply(modelvars2, function(x) x+2)
modelvars2<-sapply(modelvars2, function(x) x+2)
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
modelvars2<-as.data.frame(sapply(modelvars2, function(x) x+2))
View(modelvars2)
modelvars.unscaled<-subset(historical, select=c("Year", "tvlong", "civil.wars", "onsets", "gdppc", "polity2"))
require(tseries)
adf.test(longrun.unscaled$civil.wars)
adf.test(longrun.unscaled$onsets)
acf(longrun.unscaled$onsets)
# modelvars[c(2,5:length(names(modelvars)))]<-sapply(modelvars[c(2,5:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-subset(historical, select=c("Year", "d.civil.wars",  "ww1", "ww2", "cold", "l.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars"))
modelvars[c(1,6:length(names(modelvars)))]<-sapply(modelvars[c(1,6:length(names(modelvars)))], function(x) rescale(x))
modelvars<-modelvars[complete.cases(modelvars),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist1<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist1)
plot(modelvars$Year, z.out.hist1$result$residuals)
plot(modelvars$l.tvlong, z.out.hist1$result$residuals)
plot(modelvars$d2.civil.wars, z.out.hist1$result$residuals)
# plot(z.out$result$fitted.values, z.out$result$residuals, )
# plot(z.out$result$residuals, z.out$result$y)
z.out.hist2<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year +
ww1 + ww2 + cold,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist2)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
View(modelvars.unscaled)
View(modelvars2)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
View(modelvars2)
View(modelvars2)
modelvars2$onsets<-modelvars2$onsets+1
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
modelvars2$tvlong<-modelvars2$tvlong+1
modelvars2$l.tvlong<-modelvars2$l.tvlong+1
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2<-modelvars2[complete.cases(modelvars2),]
pewmod<-Pewma(modelvars2$onsets ~ modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 + modelvars2$d.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 + modelvars2$l.civil.wars +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
historical$ld.onsets<-shift(historical$d.onsets, -1)
historical$ld.civil.wars<-shift(historical$d.civil.wars, -1)
detach("package:Zelig", unload=TRUE)
require(arm)
longrun[c(2:length(names(longrun)))]<-sapply(longrun[c(2:length(names(longrun)))], function(x) rescale(x))
molten<-melt(historical, id="Year")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
longrun.plot<-ggplot(molten, aes(x=Year)) +
geom_line(aes(y=value, colour=variable, linetype=variable)) +
scale_colour_manual(values=cbbPalette) +
labs(y="Z (standardized)") +
theme_bw()
## Make subset for count models, standardizing all but civil war counts
modelvars.unscaled<-subset(historical, select=c("Year", "tvlong", "civil.wars", "onsets", "gdppc", "polity2"))
require(tseries)
adf.test(longrun.unscaled$civil.wars)
adf.test(longrun.unscaled$onsets)
acf(longrun.unscaled$onsets)
# modelvars[c(2,5:length(names(modelvars)))]<-sapply(modelvars[c(2,5:length(names(modelvars)))], function(x) x+abs(min(modelvars$polity2)))
modelvars<-subset(historical, select=c("Year", "d.civil.wars",  "ww1", "ww2", "cold", "l.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "l.civil.wars", "d2.civil.wars"))
modelvars[c(1,6:length(names(modelvars)))]<-sapply(modelvars[c(1,6:length(names(modelvars)))], function(x) rescale(x))
modelvars<-modelvars[complete.cases(modelvars),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist1<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist1)
plot(modelvars$Year, z.out.hist1$result$residuals)
plot(modelvars$l.tvlong, z.out.hist1$result$residuals)
plot(modelvars$d2.civil.wars, z.out.hist1$result$residuals)
# plot(z.out$result$fitted.values, z.out$result$residuals, )
# plot(z.out$result$residuals, z.out$result$y)
z.out.hist2<-zelig(d.civil.wars ~ l.tvlong + l.gdppc + l.polity2 + l2.polity2 + l.civil.wars + d2.civil.wars + Year +
ww1 + ww2 + cold,
model="ls",
robust=TRUE,
data=modelvars,
cite=F)
summary(z.out.hist2)
detach("package:Zelig", unload=TRUE)
require(arm)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2[c(1,6:length(names(modelvars2)))]<-sapply(modelvars2[c(1,6:length(names(modelvars2)))], function(x) rescale(x))
modelvars2<-modelvars2[complete.cases(modelvars2),]
detach("package:arm", unload=TRUE)
require(Zelig)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
plot(modelvars2$Year, z.out.hist3$result$residuals)
plot(modelvars2$l.tvlong, z.out.hist3$result$residuals)
plot(modelvars2$d2.civil.wars, z.out.hist3$result$residuals)
hist(modelvars2$d.onsets)
#################
source("http://www.utdallas.edu/~pbrandt/code/pests.r")
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2<-modelvars2[complete.cases(modelvars2),]
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 + modelvars2$l.civil.wars + ld.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "ld.onsets", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2<-modelvars2[complete.cases(modelvars2),]
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 + modelvars2$l.civil.wars + ld.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l2.polity2 + modelvars2$l.civil.wars + modelvars2$ld.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$ld.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 +
modelvars2$cold + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$ld.onsets +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$d.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 + modelvars2$Year)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
z.out.hist3<-zelig(onsets ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l2.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
plot(modelvars2$d2.civil.wars, z.out.hist3$result$residuals)
plot(modelvars2$onsets, z.out.hist3$result$residuals)
hist(modelvars2$d.onsets)
hist(log(modelvars2$d.onsets))
z.out.hist3<-zelig(log(onsets) ~ l.tvlong + d.tvlong + l.gdppc + l.polity2 + l2.polity2 + civil.wars + l.onsets + d.onsets + ww1 + ww2 + cold + Year,
model="negbinom",
robust=TRUE,
data=modelvars2,
cite=F)
summary(z.out.hist3)
modelvars2<-subset(historical, select=c("Year", "d.civil.wars", "d.onsets", "onsets", "ww1", "ww2", "cold", "l.tvlong", "d.tvlong", "l.gdppc",
"l.polity2", "l2.polity2", "civil.wars", "l.civil.wars", "ld.onsets", "d2.civil.wars", "l.onsets", "l2.onsets",
"d2.onsets"))
modelvars2<-modelvars2[complete.cases(modelvars2),]
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 + l.civil.wars +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 + modelvars2$Year)
pewmod<-Pewma(modelvars2$onsets ~ -1 + modelvars2$l.tvlong + modelvars2$l.gdppc + modelvars2$l.polity2 + modelvars2$l.civil.wars +
modelvars2$l.onsets + modelvars2$ww1 + modelvars2$ww2 + modelvars2$Year)
